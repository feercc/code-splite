---
description: 迭代器模式的设计与实现
---

# 迭代器模式

## 实现一个迭代器

```javascript
const each = (ary, callback) => {
  for (let i = 0; i < ary.length; i++) {
    callback.call(ary[i], i, ary[i]);
  }
};

each([1, 2, 3], (i, n) => {
  console.log(i, n);
});
```

## 外部迭代器

迭代数组

```javascript
class IteratorArray {
  constructor(array) {
    this.array = array;
    this.index = 0;
  }
  next() {
    if (this.index < this.array.length) {
      return { value: this.array[this.index++], done: false };
    } else {
      return { value: undefined, done: true };
    }
  }
}

const iterator = new IteratorArray([1, 2, 3]);
console.log(iterator.next()); // { value: 1, done: false }
console.log(iterator.next()); // { value: 2, done: false }
console.log(iterator.next()); // { value: 3, done: false }
console.log(iterator.next()); // { value: undefined, done: true }
```

迭代对象

```javascript
class IteratorObject {
  constructor(obj) {
    this.obj = obj
    this.keys = Object.keys(obj)
    this.index = 0
  }

  next() {
    if (this.index < this.keys.length) {
      return {
        value: this.obj[this.keys[this.index++]],
        done: false
      }
    } else {
      return {
        value: undefined,
        done: true
      }
    }
  }
}
```